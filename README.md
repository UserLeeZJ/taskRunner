# 简化版定时任务执行包（支持互斥组排队与优先级管理，简易日志输出，无数据库依赖）

采用了**简易的日志处理器**和**内存管理**，使得包更加轻量且易于集成。该包提供给开发者一组安全、方便、功能强大且简洁的方法，便于集成到各种 Go 项目中，而无需额外的数据库配置。

## 目录

1. [安装指南](#安装指南)
2. [项目结构](#项目结构)
3. [关键模块与代码示例](#关键模块与代码示例)
    - [配置模块](#配置模块)
    - [任务注册与管理](#任务注册与管理)
    - [互斥组管理与排队逻辑](#互斥组管理与排队逻辑)
    - [执行器模块](#执行器模块)
    - [日志管理](#日志管理)
    - [主接口](#主接口)
4. [使用示例](#使用示例)
    - [主示例](#主示例)
    - [自定义日志处理器示例](#自定义日志处理器示例)
5. [常见问题](#常见问题)
6. [测试](#测试)
7. [总结](#总结)
8. [附录](#附录)
    - [版权信息](#版权信息)
    - [贡献者名单](#贡献者名单)
    - [贡献指南](#贡献指南)
    - [项目仓库](#项目仓库)
    - [License](#license)

---

## 安装指南

确保您已经安装了 Go 环境。

```bash
go get -u github.com/UserLeeZJ/taskrunner
```

## 项目结构

```plaintext
taskrunner/
├── executor.go          // 执行器模块，负责任务的调度与执行
├── registry.go          // 任务注册与管理模块
├── mutex.go             // 互斥组管理与排队逻辑
├── logger.go            // 日志管理模块
└── ...                  // 其他相关文件
```

## 常见问题
### 任务未按预期执行
**原因**：可能是任务的依赖关系未满足或任务已被标记为运行中。
**解决方案**：
- 确认所有依赖任务已正确注册并成功执行。
- 检查任务是否被其他进程锁定，特别是在使用互斥组时。
### 任务执行超时
**原因**：任务的执行时间超过了设置的 MaxRunTimeSecs。
**解决方案**：
- 优化任务代码，减少执行时间。
- 增加任务的 MaxRunTimeSecs 设置。
### 日志未输出
**原因**：未正确设置日志处理器，或日志级别过滤。
**解决方案**：
- 确认已正确设置日志处理器。
- 检查日志处理器的实现，确保日志级别和输出路径正确。
### 任务优先级未生效
**原因**：任务优先级设置不正确，或优先级队列实现存在问题。
**解决方案**：
- 确认任务在注册时正确设置了 Priority 字段。
- 检查优先级队列的实现，确保高优先级任务先被调度和执行。
## 测试taskrunner 包提供了全面的测试覆盖，确保各模块功能的稳定性。您可以使用以下命令运行测试：

```
bash go test ./...
```

测试覆盖了任务注册、调度、执行、依赖关系、互斥组管理以及日志输出等关键功能。
## 附录### 版权信息MIT © [UserLeeZJ](https://github.com/UserLeeZJ)
### 贡献者名单感谢所有贡献者的辛勤工作：
- [UserLeeZJ](https://github.com/UserLeeZJ)
### 贡献指南欢迎提交 Issue 和 Pull Request。
请确保遵循以下步骤：
1. Fork 本仓库
2. 创建您的特性分支 (git checkout -b feature/新特性)
3. 提交您的更改 (git commit -m '添加新特性')
4. 推送到分支 (git push origin feature/新特性)
5. 创建一个新的 Pull Request请确保您的代码符合编码规范，并通过所有测试。

### 项目仓库 [https://github.com/UserLeeZJ/taskrunner](https://github.com/UserLeeZJ/taskrunner)
### License本项目采用 [MIT License](LICENSE) 许可协议。详情请参阅 [LICENSE](LICENSE) 文件。